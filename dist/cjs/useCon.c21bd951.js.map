{"mappings":";;;;;;;;;;;;;;;AAwBe,kDAId,OAAc,EACd,OAAqC;IAErC,MAAM,CACL,OACA,SACA,GAAG,CAAA,GAAA,qBAAO,EAAG;QACb,MAAM,YACL,WAAW,CAAA,GAAA,iCAAc,GACzB,GAAG,UACH,GAAG,WAAW,CAAC;QAChB,MAAM,WAAW,CAAA,GAAA,iCAAQ,EAAG,SAAS;QAErC,MAAM,cAAc;YACnB,GAAG,QAAQ;YACX,UAAU,GAAG,IAA0C;gBACtD,MAAM,CACL,OACA,UACA,GAAG,SAAS,QAAQ,IAAK;gBAE1B,SAAS;oBACR,MAAM,aAAa,SAAS,GAAG;oBAC/B,MAAM,UAAU;oBAChB,MAAM,aAAa,SAAS,GAAG;oBAC/B,IAAK,eAAe,YACnB,OAAO;oBAER,SAAU,SAAU;wBACnB,GAAG,aAAa,GAAG,EAAE;wBACrB,GAAG,YAAY;oBAChB;oBACA,OAAO;gBACR;gBAEA,OAAO;oBACN;oBACA;iBACA;YACF;YACA;gBACC,MAAM,aAAa,SAAS,GAAG;gBAC/B,MAAM,UAAU,SAAS,KAAK;gBAC9B,MAAM,aAAa,SAAS,GAAG;gBAC/B,IAAK,eAAe,YACnB,OAAO;gBAER,SAAU,SAAU;oBACnB,GAAG,aAAa,GAAG,EAAE;oBACrB,GAAG,YAAY;gBAChB;gBACA,OAAO;YACR;YACA,KAAK,GAAG,IAAqC;gBAC5C,MAAM,aAAa,SAAS,GAAG;gBAC/B,MAAM,UAAU,SAAS,GAAG,IAAK;gBACjC,MAAM,aAAa,SAAS,GAAG;gBAC/B,IAAK,eAAe,YACnB,OAAO;gBAER,SAAU,SAAU;oBACnB,GAAG,aAAa,GAAG,EAAE;oBACrB,GAAG,YAAY;gBAChB;gBACA,OAAO;YACR;QACD;QACA,MAAM,eAAe,CAAA,GAAA,iCAAY,EAAG,aAAa,SAAS;QAE1D,OAAO,SAAU;YAChB,GAAG,YAAY;YACf,GAAG,YAAY,GAAG,EAAE;QACrB;IACD;IAEA,OAAO;AACR","sources":["src/useCon.ts"],"sourcesContent":["import { useState, } from 'react';\nimport createCon from './_internal/createCon';\nimport createConActs from './_internal/createConActs';\nimport defaultSelector from './_internal/defaultSelector';\nimport type { ActRecord, } from './types/ActRecord';\nimport type { DS, } from './types/DS';\nimport type { UseEstadoProps, } from './types/UseEstadoProps';\nimport type { Selector, } from './types/Selector';\n\nexport default function useCon<\n\tState extends DS,\n\tActs extends ActRecord,\n\tSel extends Selector<State, Acts>,\n>(\n\tinitial: State,\n\toptions: UseEstadoProps<State, Acts> & { selector: Sel }\n): ReturnType<Sel>;\nexport default function useCon<\n\tState extends DS,\n\tActs extends ActRecord,\n>(\n\tinitial: State,\n\toptions?: Omit<UseEstadoProps<State, Acts>, 'selector'>\n): ReturnType<typeof defaultSelector<State, Acts>>;\nexport default function useCon<\n\tState extends DS,\n\tActs extends ActRecord,\n>(\n\tinitial: State,\n\toptions?: UseEstadoProps<State, Acts>,\n) {\n\tconst [\n\t\tstate,\n\t\tsetState,\n\t] = useState( () => {\n\t\tconst {\n\t\t\tselector = defaultSelector<State, Acts>,\n\t\t\t..._options\n\t\t} = options ?? {};\n\t\tconst conProps = createCon( initial, _options, );\n\n\t\tconst conActProps = {\n\t\t\t...conProps,\n\t\t\tgetDraft( ...args: Parameters<typeof conProps.getDraft> ) {\n\t\t\t\tconst [\n\t\t\t\t\tdraft,\n\t\t\t\t\t_finalize,\n\t\t\t\t] = conProps.getDraft( ...args, );\n\n\t\t\t\tfunction finalize() {\n\t\t\t\t\tconst oldHistory = conProps.get();\n\t\t\t\t\tconst results = _finalize();\n\t\t\t\t\tconst newHistory = conProps.get();\n\t\t\t\t\tif ( oldHistory === newHistory ) {\n\t\t\t\t\t\treturn results;\n\t\t\t\t\t}\n\t\t\t\t\tsetState( selector( {\n\t\t\t\t\t\t...propsConActs.get(),\n\t\t\t\t\t\t...propsConActs,\n\t\t\t\t\t}, ), );\n\t\t\t\t\treturn results;\n\t\t\t\t}\n\n\t\t\t\treturn [\n\t\t\t\t\tdraft,\n\t\t\t\t\tfinalize,\n\t\t\t\t];\n\t\t\t},\n\t\t\treset() {\n\t\t\t\tconst oldHistory = conProps.get();\n\t\t\t\tconst results = conProps.reset();\n\t\t\t\tconst newHistory = conProps.get();\n\t\t\t\tif ( oldHistory === newHistory ) {\n\t\t\t\t\treturn results;\n\t\t\t\t}\n\t\t\t\tsetState( selector( {\n\t\t\t\t\t...propsConActs.get(),\n\t\t\t\t\t...propsConActs,\n\t\t\t\t}, ), );\n\t\t\t\treturn results;\n\t\t\t},\n\t\t\tset( ...args: Parameters<typeof conProps.set> ) {\n\t\t\t\tconst oldHistory = conProps.get();\n\t\t\t\tconst results = conProps.set( ...args, );\n\t\t\t\tconst newHistory = conProps.get();\n\t\t\t\tif ( oldHistory === newHistory ) {\n\t\t\t\t\treturn results;\n\t\t\t\t}\n\t\t\t\tsetState( selector( {\n\t\t\t\t\t...propsConActs.get(),\n\t\t\t\t\t...propsConActs,\n\t\t\t\t}, ), );\n\t\t\t\treturn results;\n\t\t\t},\n\t\t} as typeof conProps;\n\t\tconst propsConActs = createConActs( conActProps, options?.acts, );\n\n\t\treturn selector( {\n\t\t\t...propsConActs,\n\t\t\t...conActProps.get(),\n\t\t}, );\n\t}, );\n\n\treturn state;\n}\n"],"names":[],"version":3,"file":"useCon.c21bd951.js.map"}